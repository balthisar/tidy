--	Balthisar Tidy Batch----	A simple batch script for Balthisar Tidy.----	Created by: Jim Derry--	Created on: 04/20/14 14:47:44----	Copyright Â© 2014 Jim Derry--	All Rights Reserved--------------------------------------------------------------------	open--		User dropped files onto the applet, or we arrived here--		after on run.----------------------------------------------------------------on open theFiles		----------------------------------------------	-- Locals for debugger visibility	----------------------------------------------	local theDestination, myCompleteDestination		----------------------------------------------	-- Understand the user's intentions	----------------------------------------------	try		set theMessage to "You are about to Tidy " & (count of theFiles) & " file(s). Do you wish to do this in-place or by choosing a destination folder?"		set theChoice to display dialog theMessage with title "Balthisar Tidy Batch Sample Script" buttons {"Cancel", "In-Place", "Choose Folder"} default button "Choose Folder"	on error		return	end try		----------------------------------------------	-- Set desired destination. We can't	-- tell Tidy to save outside of its	-- sandbox anymore, so we will have	-- Tidy select a folder instead of	-- doing it in this script.	----------------------------------------------	if (button returned of theChoice is "Choose Folder") then		tell application "Balthisar Tidy for Work"			activate			set theDestination to saveAsDestination		end tell	else		set theDestination to ""	end if		----------------------------------------------	-- Loop through all of the files.	----------------------------------------------	repeat with theFileAlias in theFiles				tell application "Balthisar Tidy for Work"						set theOpenDocument to (open theFileAlias)						if (theDestination is "") then				-- in place				save theOpenDocument			else				-- in new destination				tell application "Finder" to set myFileNamePart to the name of theFileAlias				set myCompleteDestination to (POSIX path of theDestination) & "/" & myFileNamePart				save theOpenDocument in (myCompleteDestination)			end if						close theOpenDocument					end tell			end repeat			----------------------------------------------	-- Done!	----------------------------------------------	tell me to activate	okDialog("Done Tidying " & (count of theFiles) & " file(s).")	end open------------------------------------------------------------------	run--		User will choose files with file browser----------------------------------------------------------------on run	--	Handle the case where the script is launched without any dropped files	try		open (choose file with prompt "Choose one more files to Tidy" of type {"public.html", "public.php-script", "public.xml"} with multiple selections allowed)	end tryend run------------------------------------------------------------------	okDialog----------------------------------------------------------------on okDialog(theMessage)		return display dialog (theMessage as text) buttons {"OK"} default button "OK"	end okDialog