<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <title>Use AppleScript to Control <em>Balthisar Tidy</em></title>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <link href="../assets/stylesheets/style.css" rel="stylesheet" />
    <link href="../assets/stylesheets/image_sizes.css" rel="stylesheet" />
    <script src="../assets/javascripts/all.js"></script>
  </head>
  <body class='applescript advanced Resources Resources_Base'>
    <nav id='breadcrumbs'>
      <div class='breadcrumbs'>
        <ul>
          <li><a href="../index.html">Balthisar Tidy Help</a></li>
          <li><a href="index.html">Use Advanced Features of Balthisar Tidy</a></li>
          <li><a href="applescript.html">Use AppleScript to Control <em>Balthisar Tidy</em></a></li>
        </ul>
      </div>
    </nav>
    <div class='container-logo-medium'>
      <div>
        <div class='yield-content'>
          
          <h1 id="use-applescript-to-control-embalthisar-tidyem">Use AppleScript to Control <em>Balthisar Tidy</em></h1>
          
          <p><em>Balthisar Tidy for Work</em>’s support for AppleScript empowers you to put the power of
          automation to work for you. Here are just a few ideas of the things you can
          do:</p>
          
          <ul>
            <li>
              <p>Use a batch script to Tidy in place dozens, hundreds, or even thousands of
          files.</p>
            </li>
            <li>
              <p>Supercharge the batch script to Tidy your files and copy them to a server
          directory.</p>
            </li>
            <li>
              <p>Use Mac OS X’ <strong>Folder Actions</strong> to Tidy a file every time you save
          or copy it into the folders of your choice.</p>
            </li>
          </ul>
          
          <p>To get started making your own scripts, simply look at <em>Balthisar Tidy for Work</em>’s
          AppleScript dictionary in the AppleScript editor of your choice.</p>
          
          <h2 id="sample-applescripts">Sample AppleScripts</h2>
          
          <p><em>Balthisar Tidy for Work</em> comes with several example scripts that demonstrate a
          little bit of the power the AppleScript offers to you. The scripts include
          added features that make <em>Balthisar Tidy for Work</em> work even better for you, such
          as:</p>
          
          <ul>
            <li>
              <p>Use <em>Balthisar Tidy for Work</em> as a batch processor for multiple document tidying.</p>
            </li>
            <li>
              <p>Use Mac OS X’s <strong>Folder Actions</strong> to automatically Tidy documents
          placed into a specific folder.</p>
            </li>
            <li>
              <p>Scripts that can be installed into <strong>BBEdit</strong> or <strong>TextWrangler</strong> text editors
          in order to provide always-available, instant tidying from within those
          environments.</p>
            </li>
          </ul>
          
          <p>These sample scripts are included on a disk image inside <em>Balthisar Tidy for Work</em>’s
          application bundle for your convenience.</p>
          
          <p class="note"><a href="x-help-script://com.balthisar.Balthisar-Tidy.pro.help/assets/applescripts/open_dmg.scpt?AppleScriptsforTidy.dmg"><em>Open the disk image now</em></a>.</p>
          
          <p class="note">Note that if you are viewing this documentation in a web browser, then that link
          won’t work for you. Just open <em>Balthisar Tidy for Work</em>’s bundle and you can find
          the disk image.</p>
          
          <h2 id="balthisar-tidy-for-work-and-balthisar-tidy-service-helper"><em>Balthisar Tidy for Work</em> and <em>Balthisar Tidy Service Helper</em></h2>
          
          <p>Some of <em>Balthisar Tidy for Work</em>’s AppleScript functionality is provided by a
          separate, faceless, background application called <em>Balthisar Tidy Service
          Helper</em>. It’s a good option for using AppleScript instead of using
          <em>Balthisar Tidy for Work</em> directly because it’s small, lightweight, and can produce
          Tidy’d text without loading the entire <em>Balthisar Tidy for Work</em> application.</p>
          
          <p>The APIs for both applications are described below.</p>
          
          <h2 id="the-balthisar-tidy-for-work-applescript-api">The <em>Balthisar Tidy for Work</em> AppleScript API</h2>
          
          <h3 id="the-standard-suite">The Standard Suite</h3>
          
          <p><em>Balthisar Tidy for Work</em> supports the entire Standard Suite. Please consult
          Apple’s AppleScript documentation (see the sidebar for links) for a description
          of all of these features.</p>
          
          <h3 id="the-document-suite">The Document Suite</h3>
          
          <p>While the Standard Suite gives you a lot of power, the Document Suite provides
          two additional AppleScript properties that will be critical to your automation
          workflow.</p>
          
          <dl>
            <dt><code>sourceText</code></dt>
            <dd>If you set this document property with some untidy HTML, it will be Tidy’d
          using the Preferences from Tidy options and made available immediately via
          the <code>tidyText</code> property.</dd>
            <dt><code>tidyText</code></dt>
            <dd>This read only property returns the Tidy’d value of the <code>sourceText</code> that
          you set.</dd>
          </dl>
          
          <h3 id="developer-scripting-suite">Developer Scripting Suite</h3>
          
          <p>The developer suite is primarily useful to the developers of
          <em>Balthisar Tidy for Work</em>, but can offer some utility to you if also used with
          UI Scripting. In addition, because of application sandboxing, there is one
          critical property available in the developer suite that will be useful if you
          want to perform the equivalent of <strong>Save As…</strong> using AppleScript.</p>
          
          <dl>
            <dt><code>countOfPrefsWindowPanels</code></dt>
            <dd>This read-only property displays the number of Preferences panels that are
          available in <em>Balthisar Tidy for Work</em>’s <a href="../reference/prefs/index.html" title="Balthisar Tidy Preferences">Preferences</a> window. Some
          variations of <em>Balthisar Tidy</em> have a different number of panels.</dd>
            <dt><code>documentWindowIsInScreenshotMode</code></dt>
            <dd>This property serves absolutely no purpose to normal developers whatsoever,
          unless you happen to have the need to hide the document window when the
          various helpers are shown. This may be the case if you want to take easy,
          clear screenshots of <em>Balthisar Tidy for Work</em>’s various interface elements so
          that you can provide excellent, high-quality, world-class documentation.
          
              <p>When this property is <code>true</code> the document window will adjust itself to 100%
          transparency when helpers appear. This gives various screen shot utilities
          the ability to capture them without the document window in the background.</p>
            </dd>
            <dt><code>identifierOfVisiblePrefsWindowPanel</code></dt>
            <dd>This read-only property returns the unique, internal identifier of the
          currently-visible preferences panel.</dd>
            <dt><code>indexOfVisiblePrefsWindowPanel</code></dt>
            <dd>This property indicates/sets the currently visible preference panel. It uses
          a 1-based index.</dd>
            <dt><code>preferencesWindowIsVisible</code></dt>
            <dd>This property indicates/sets whether the Preferences window is open or not
          (but not necessarily “visible” if occluded by another item on screen.)</dd>
            <dt><code>saveAsDestination</code></dt>
            <dd>Returns the POSIX path of the user-chosen directory after presenting a file
          open dialog to the user. Because <em>Balthisar Tidy for Work</em> is sandboxed, the
          operating system prevents it from saving files to paths not specifically
          chosen by the user. Therefore instead of using AppleScript to ask the user to
          select a destination, ask <em>Balthisar Tidy for Work</em> to ask the user instead. This
          path will remain valid until the next time <em>Balthisar Tidy for Work</em> launches.</dd>
            <dt><code>titleOfVisiblePrefsWindowPanel</code></dt>
            <dd>This read-only property returns the localized name of the currently-visible
          Preferences window panel.</dd>
          </dl>
          
          <h3 id="applescript-ui-scripting">AppleScript UI Scripting</h3>
          
          <p>In addition to its built-in AppleScript support, <em>Balthisar Tidy for Work</em> also
          plays nicely with UI Scripting. See the link in the sidebar for more information
          about using UI Scripting.</p>
          
          <h2 id="the-balthisar-tidy-service-helper-api">The <em>Balthisar Tidy Service Helper</em> API</h2>
          
          <p>The <em>Balthisar Tidy Service Helper</em> API does <em>not</em> support the standard
          AppleScript suite. Rather it is a single purpose, lightweight tool to provide
          Tidying services without cluttering your screen with a GUI. It consists of a
          limited Application Suite toward this end.</p>
          
          <h3 id="the-application-suite">The Application Suite</h3>
          
          <p>Unlike scripting <em>Balthisar Tidy for Work</em> wherein all Tidying is document-based
          and contained within isolated containers, <em>Balthisar Tidy Service Helper</em> is
          a single instance. This means that the following properties are available
          system-wide to any AppleScript that chooses to use them.</p>
          
          <p>If you attempt to use these properties simultaneously from multiple scripts 
          running at the same time, your results could be quite interesting. It’s “safe”
          to do so in that no harm will come to your computer, but the results are subject
          to a first-come, first-serve basis that you have no control over. Still, they
          provide very light weight, very quick Tidying system wide.</p>
          
          <dl>
            <dt><code>sourceText</code></dt>
            <dd>If you set this property with some untidy HTML, it will be Tidy’d
          using the Tidy options in Preferences and made available immediately via the
          <code>tidyText</code> and <code>tidyBodyText</code> properties.</dd>
            <dt><code>tidyText</code></dt>
            <dd>This read only property returns the Tidy’d value of the <code>sourceText</code> that
          you set. It will always return a full HTML document regardless of
          <em>Balthisar Tidy for Work</em>’s <code>show-body-only</code> setting.</dd>
            <dt><code>tidyBodyText</code></dt>
            <dd>This read only property returns the Tidy’d value of the <code>sourceText</code> that
          you set. It will only ever return the body portion of an HTML document
          regardless of <em>Balthisar Tidy for Work</em>’s <code>show-body-only</code> setting. This can
          be quite useful if you only wish to Tidy snippets of text.</dd>
          </dl>
        </div>
      </div>
      <div>
        <div>
          <img src="../../shared/icon_256x256.png" alt="logo" srcset="../../shared/icon_256x256@2x.png 2x" />
        </div>
        <div class='related_topics'>
          <div class='related-topics'>
            <ul>
              <li><a href="service.html">Use <em>Balthisar Tidy</em> as a System Service</a></li>
              <li><a href="extension.html">Use Tidy as an Action Extension</a></li>
              <li><a href="export_config.html">Use Your Tidy Options with Command Line Tidy</a></li>
              <li><a href="use_themes.html">Use Themes to Customize your Environment</a></li>
              <li><a href="use_exportrtf.html">Export Rich Text Files (RTF)</a></li>
              <li><a href="use_tidylib.html">Use a different version of LibTidy</a></li>
            </ul>
          </div>
          <h1>See Also</h1>
          <ul>
              <li><a href="https://developer.apple.com/library/mac/documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html">AppleScript Language Guide</a></li>
              <li><a href="http://www.macosxautomation.com/applescript/uiscripting/index.html">AppleScript UI Scripting</a></li>
          </ul>
        </div>
      </div>
    </div>
  </body>
</html>
